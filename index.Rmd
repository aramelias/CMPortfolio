---
title: "Computational Musicology Portfolio"
author: "Aram Elias"
date: "Feb 14, 2021"
output: html_document
---

```{r}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(spotifyr)
library(ggplot2)
```

# Analysis: Ayreon
Dutch progressive-metal band, *Ayreon*, has released six concept albums between 1995 and 2017 that are known for their unique sound. It may be worthwhile to compare these albums to one another to see how the band has developed over time.

Some songs in different albums reference one another, and for these it could also be interesting to see how much they have in common musically speaking. Some other songs are considered outliers due to not sounding the same as the rest of the album, or even having more in common with other albums to the human ear.

With most songs being over five minutes in length and having distinct musical segments with complex rhythms, and each album consisting of about fifteen songs, a large amount of data on this band is available on Spotify.

A limitation of this corpus would be a lack of other material to compare it with; however, with the band citing older bands such as Pink Floyd as inspiration, looking into similarities there might also be a good avenue for research.

```{r}
# Retrieve data
ayreon <- get_playlist_audio_features("", "3O1z9gRNz9DiB9wujbgLiV")

# Remove stray song
ayreon <- subset(ayreon, track.album.name != "Timeline")

# Remove unnecessary columns (mostly empty or irrelevant to the music itself)
ayreon <- subset(ayreon, select = -c(playlist_id, playlist_name, playlist_img, playlist_owner_name, playlist_owner_id,
                  added_at, primary_color, added_by.href, added_by.id, added_by.type, added_by.uri, added_by.external_urls.spotify,
                  track.artists, track.available_markets, track.disc_number, track.episode, track.explicit,
                  is_local, track.is_local, track.preview_url, track.track, track.type, video_thumbnail.url, mode,
                  track.album.album_type, track.album.artists, track.album.available_markets, track.album.href,
                  track.album.id, track.album.images, track.album.release_date_precision, track.album.type))

# Clean up some album names
ayreon$track.album.name[ayreon$track.album.name == "The Final Experiment (Special Edition)"] <- "The Final Experiment"
ayreon$track.album.name[ayreon$track.album.name == "Universal Migrator Pt.1 & 2"] <- "Universal Migrator"
ayreon$mode_name <- ifelse(ayreon$mode_name == "minor", "Minor", "Major")

ayreon
```

# Plotting
This plot is an overview of Ayreon's six albums.
```{r}
ggplot(ayreon, aes(x = energy, y = valence, size = loudness, fill = mode_name)) +
  geom_point(shape = 21, color = "#000000", alpha = 0.5) +
  scale_x_continuous(limits = c(0, 1), breaks = c(0, 0.5, 1), minor_breaks = NULL) +
  scale_y_continuous(limits = c(0, 1), breaks = c(0, 0.5, 1), minor_breaks = NULL) +
  scale_size_continuous(trans = "exp", guide = "none") +
  facet_wrap(~track.album.name) +
  theme_linedraw() +
  labs(x = "Energy", y = "Valence", size = "Loudness", fill = "Mode")
```
